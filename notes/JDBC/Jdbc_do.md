**Core Java + H2 + JDBC** example you can run on **Windows in IntelliJ**, with **no Maven/Gradle**. Works on **Java 17 or 21** 

---

# 1) Set up the project (IntelliJ, no build tool)

1. **Create project**

   * IntelliJ → **New Project** → **Java** → *No build tools*.
   * **SDK**: choose **17** or **21**.
   * Name it e.g. `H2BankDemo`.

2. **Download H2 JDBC driver (single JAR)**

   * Get the latest `h2-*.jar` from H2’s downloads page (any recent 2.x is fine).
   * Save it somewhere like `C:\libs\h2.jar`.

3. **Add the JAR to the project**

   * IntelliJ → **File** → **Project Structure…** (or `Ctrl+Alt+Shift+S`) → **Modules** → **Dependencies** tab → **+** → **JARs or directories…** → pick `C:\libs\h2.jar` → **Apply**.

4. **Create a data folder** (so the DB file lives in your project)

   * In the project root, create folder `data` (right-click project → **New** → **Directory** → `data`).

---

# 2) Minimal code (3 small classes)

Create a package (e.g. `bank`) and add these files.

## `bank/Customer.java`

```java
package bank;

import java.math.BigDecimal;
import java.util.Objects;

public class Customer {
    private Long id;
    private String name;
    private BigDecimal balance;

    public Customer(Long id, String name, BigDecimal balance) {
        this.id = id;
        this.name = name;
        this.balance = balance;
    }

    public Customer(String name, BigDecimal balance) {
        this(null, name, balance);
    }

    public Long getId() { return id; }
    public String getName() { return name; }
    public BigDecimal getBalance() { return balance; }

    public void setId(Long id) { this.id = id; }
    public void setName(String name) { this.name = name; }
    public void setBalance(BigDecimal balance) { this.balance = balance; }

    @Override public String toString() {
        return "Customer{id=" + id + ", name='" + name + "', balance=" + balance + '}';
    }

    @Override public boolean equals(Object o) {
        if (this == o) return true;
        if (!(o instanceof Customer c)) return false;
        return Objects.equals(id, c.id) && Objects.equals(name, c.name) && Objects.equals(balance, c.balance);
    }
    @Override public int hashCode() { return Objects.hash(id, name, balance); }
}
```

## `bank/Db.java`

```java
package bank;

import java.sql.*;

public final class Db {
    // File-based DB stored under ./data/bankdb (relative to project root).
    // AUTO_SERVER=TRUE lets other tools (like H2 Console) connect while the app is running.
    private static final String URL  = "jdbc:h2:file:./data/bankdb;AUTO_SERVER=TRUE";
    private static final String USER = "sa";
    private static final String PASS = "";

    private Db() {}

    public static Connection getConnection() throws SQLException {
        // With JDBC 4+ you don't need Class.forName("org.h2.Driver")
        return DriverManager.getConnection(URL, USER, PASS);
    }

    // Create table once (runs at startup)
    public static void initSchema() {
        String ddl = """
            CREATE TABLE IF NOT EXISTS CUSTOMER (
                ID BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
                NAME VARCHAR(100) NOT NULL,
                BALANCE DECIMAL(19,2) NOT NULL
            );
            """;
        try (Connection con = getConnection();
             Statement st = con.createStatement()) {
            st.execute(ddl);
        } catch (SQLException e) {
            throw new RuntimeException("Failed to initialize schema", e);
        }
    }
}
```

## `bank/CustomerDao.java`

```java
package bank;

import java.math.BigDecimal;
import java.sql.*;
import java.util.ArrayList;
import java.util.List;
import java.util.Optional;

public class CustomerDao {

    public Customer insert(Customer c) throws SQLException {
        String sql = "INSERT INTO CUSTOMER (NAME, BALANCE) VALUES (?, ?)";
        try (Connection con = Db.getConnection();
             PreparedStatement ps = con.prepareStatement(sql, Statement.RETURN_GENERATED_KEYS)) {
            ps.setString(1, c.getName());
            ps.setBigDecimal(2, c.getBalance());
            ps.executeUpdate();
            try (ResultSet rs = ps.getGeneratedKeys()) {
                if (rs.next()) c.setId(rs.getLong(1));
            }
            return c;
        }
    }

    public Optional<Customer> findById(long id) throws SQLException {
        String sql = "SELECT ID, NAME, BALANCE FROM CUSTOMER WHERE ID = ?";
        try (Connection con = Db.getConnection();
             PreparedStatement ps = con.prepareStatement(sql)) {
            ps.setLong(1, id);
            try (ResultSet rs = ps.executeQuery()) {
                if (rs.next()) {
                    return Optional.of(map(rs));
                }
                return Optional.empty();
            }
        }
    }

    public List<Customer> findAll() throws SQLException {
        String sql = "SELECT ID, NAME, BALANCE FROM CUSTOMER ORDER BY ID";
        try (Connection con = Db.getConnection();
             PreparedStatement ps = con.prepareStatement(sql);
             ResultSet rs = ps.executeQuery()) {
            List<Customer> out = new ArrayList<>();
            while (rs.next()) out.add(map(rs));
            return out;
        }
    }

    public boolean updateBalance(long id, BigDecimal newBalance) throws SQLException {
        String sql = "UPDATE CUSTOMER SET BALANCE = ? WHERE ID = ?";
        try (Connection con = Db.getConnection();
             PreparedStatement ps = con.prepareStatement(sql)) {
            ps.setBigDecimal(1, newBalance);
            ps.setLong(2, id);
            return ps.executeUpdate() == 1;
        }
    }

    public boolean delete(long id) throws SQLException {
        String sql = "DELETE FROM CUSTOMER WHERE ID = ?";
        try (Connection con = Db.getConnection();
             PreparedStatement ps = con.prepareStatement(sql)) {
            ps.setLong(1, id);
            return ps.executeUpdate() == 1;
        }
    }

    // Simple money transfer with transaction + rollback on failure
    public void transfer(long fromId, long toId, BigDecimal amount) throws SQLException {
        if (amount.signum() <= 0) throw new IllegalArgumentException("amount must be positive");

        String debit = "UPDATE CUSTOMER SET BALANCE = BALANCE - ? WHERE ID = ? AND BALANCE >= ?";
        String credit = "UPDATE CUSTOMER SET BALANCE = BALANCE + ? WHERE ID = ?";

        try (Connection con = Db.getConnection()) {
            con.setAutoCommit(false);
            try (PreparedStatement ps1 = con.prepareStatement(debit);
                 PreparedStatement ps2 = con.prepareStatement(credit)) {

                // debit
                ps1.setBigDecimal(1, amount);
                ps1.setLong(2, fromId);
                ps1.setBigDecimal(3, amount);
                int rows1 = ps1.executeUpdate();
                if (rows1 != 1) {
                    con.rollback();
                    throw new SQLException("Debit failed (insufficient funds or fromId not found)");
                }

                // credit
                ps2.setBigDecimal(1, amount);
                ps2.setLong(2, toId);
                int rows2 = ps2.executeUpdate();
                if (rows2 != 1) {
                    con.rollback();
                    throw new SQLException("Credit failed (toId not found)");
                }

                con.commit();
            } catch (SQLException e) {
                con.rollback();
                throw e;
            } finally {
                con.setAutoCommit(true);
            }
        }
    }

    private static Customer map(ResultSet rs) throws SQLException {
        return new Customer(
                rs.getLong("ID"),
                rs.getString("NAME"),
                rs.getBigDecimal("BALANCE")
        );
    }
}
```

## `bank/Main.java`

```java
package bank;

import java.math.BigDecimal;
import java.util.List;

public class Main {
    public static void main(String[] args) {
        Db.initSchema();
        CustomerDao dao = new CustomerDao();

        try {
            // Seed only if table empty
            if (dao.findAll().isEmpty()) {
                dao.insert(new Customer("Alice", new BigDecimal("1000.00")));
                dao.insert(new Customer("Bob",   new BigDecimal("500.00")));
            }

            System.out.println("== Customers (before) ==");
            print(dao.findAll());

            // Update a balance directly
            var alice = dao.findAll().stream().filter(c -> c.getName().equals("Alice")).findFirst().orElseThrow();
            dao.updateBalance(alice.getId(), new BigDecimal("1200.00"));

            // Transfer 150 from Alice to Bob (transactional)
            var bob = dao.findAll().stream().filter(c -> c.getName().equals("Bob")).findFirst().orElseThrow();
            dao.transfer(alice.getId(), bob.getId(), new BigDecimal("150.00"));

            System.out.println("\n== Customers (after) ==");
            print(dao.findAll());

        } catch (Exception e) {
            e.printStackTrace();
        }
    }

    private static void print(List<Customer> customers) {
        for (Customer c : customers) {
            System.out.println(c);
        }
    }
}
```

---

# 3) Run it

* Right-click `Main.main()` → **Run 'Main.main()'**.
* First run will create `./data/bankdb.mv.db` (your database file) and seed rows. You’ll see balances change after the transfer.

---

# 4) (Optional) Open H2 Console to inspect the DB

Two easy options:

**A) From command line**

```bat
cd C:\libs
java -jar h2.jar
```

* A small window opens; click **H2 Console** (or it auto-opens in browser).
* **JDBC URL**: `jdbc:h2:file:PATH_TO_YOUR_PROJECT\data\bankdb`
* **User**: `sa`  |  **Password**: *(leave blank)*

**B) Programmatically (quick and dirty)**
Add this one-liner anywhere you like to launch the console:

```java
org.h2.tools.Console.main();
```

---

# 5) Notes & tweaks

* **No `Class.forName` needed** for H2 with JDBC 4+, but you can call it if you want: `Class.forName("org.h2.Driver");`.
* **Windows paths**: if you use an absolute path in the JDBC URL, prefer forward slashes in Java strings, e.g.

  ```java
  "jdbc:h2:file:C:/work/H2BankDemo/data/bankdb;AUTO_SERVER=TRUE"
  ```
* **Reset the database**: delete the `data/bankdb.*` files and re-run.
* **Switch to in-memory DB** for quick tests:

  ```java
  "jdbc:h2:mem:bankdb;DB_CLOSE_DELAY=-1"
  ```

  (Remember: data vanishes when the JVM exits.)
